{% extends "base/base.html" %}

{% block title %}Département HSE{% endblock %}

{% block extra_css %}
<style>
    .page-header {
        background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        color: white;
        padding: 3rem 0;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }

    .stat-card {
        background: white;
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 1rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-5px);
    }

    .feature-card {
        background: white;
        border-radius: 10px;
        padding: 1.5rem;
        height: 100%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
    }

    .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .feature-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
        font-size: 1.5rem;
    }

    .bg-safety { background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); }
    .bg-environment { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); }
    .bg-health { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); }
    .bg-training { background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%); }

    .quick-action {
        padding: 0.5rem 1rem;
        border-radius: 5px;
        margin-bottom: 0.5rem;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        color: #2c3e50;
        text-decoration: none;
    }

    .quick-action:hover {
        background: #f8f9fa;
        transform: translateX(5px);
    }

    .quick-action i {
        margin-right: 0.5rem;
    }

    .chart-container {
        position: relative;
        margin: auto;
        height: 300px;
        margin-top: 1rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h1 class="display-4 mb-2">Hygiène, Sécurité et Environnement</h1>
                <p class="lead text-white-50">Gestion de la sécurité, de la santé et de l'environnement</p>
            </div>
            <div class="col-md-4 text-md-end">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb justify-content-md-end mb-0">
                        <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}" class="text-white">Accueil</a></li>
                        <li class="breadcrumb-item"><a href="{{ url_for('departements') }}" class="text-white">Départements</a></li>
                        <li class="breadcrumb-item active" aria-current="page">HSE</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <!-- Statistics Row -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="stat-card">
                <h3 class="h5 mb-3">Incidents ce mois</h3>
                <h2 class="display-4 mb-0">12</h2>
                <p class="text-muted">-15% vs mois dernier</p>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card">
                <h3 class="h5 mb-3">Audits réalisés</h3>
                <h2 class="display-4 mb-0">8</h2>
                <p class="text-muted">+2 cette semaine</p>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card">
                <h3 class="h5 mb-3">Formations</h3>
                <h2 class="display-4 mb-0">5</h2>
                <p class="text-muted">En cours</p>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card">
                <h3 class="h5 mb-3">Conformité</h3>
                <h2 class="display-4 mb-0">95<small>%</small></h2>
                <p class="text-muted">+2% ce mois</p>
            </div>
        </div>
    </div>

    <!-- Main Features Row -->
    <div class="row g-4 mb-4">
        <div class="col-md-6 col-lg-3">
            <div class="feature-card">
                <div class="feature-icon bg-safety text-white">
                    <i class="fas fa-hard-hat"></i>
                </div>
                <h5>Sécurité</h5>
                <div class="quick-actions mt-3">
                    <a href="#" class="quick-action">
                        <i class="fas fa-clipboard-list"></i>
                        Rapports d'incidents
                    </a>
                    <a href="#" class="quick-action">
                        <i class="fas fa-exclamation-triangle"></i>
                        Signaler un risque
                    </a>
                    <a href="#" class="quick-action">
                        <i class="fas fa-tasks"></i>
                        Inspections
                    </a>
                </div>
            </div>
        </div>
        
        <div class="col-md-6 col-lg-3">
            <div class="feature-card">
                <div class="feature-icon bg-environment text-white">
                    <i class="fas fa-leaf"></i>
                </div>
                <h5>Environnement</h5>
                <div class="quick-actions mt-3">
                    <a href="#" class="quick-action">
                        <i class="fas fa-chart-line"></i>
                        Suivi environnemental
                    </a>
                    <a href="#" class="quick-action">
                        <i class="fas fa-recycle"></i>
                        Gestion des déchets
                    </a>
                    <a href="#" class="quick-action">
                        <i class="fas fa-file-alt"></i>
                        Rapports mensuels
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="feature-card">
                <div class="feature-icon bg-health text-white">
                    <i class="fas fa-heartbeat"></i>
                </div>
                <h5>Santé</h5>
                <div class="quick-actions mt-3">
                    <a href="#" class="quick-action">
                        <i class="fas fa-notes-medical"></i>
                        Visites médicales
                    </a>
                    <a href="#" class="quick-action">
                        <i class="fas fa-first-aid"></i>
                        Premiers secours
                    </a>
                    <a href="#" class="quick-action">
                        <i class="fas fa-virus"></i>
                        Protocoles sanitaires
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="feature-card">
                <div class="feature-icon bg-training text-white">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h5>Formation</h5>
                <div class="quick-actions mt-3">
                    <a href="#" class="quick-action">
                        <i class="fas fa-calendar-alt"></i>
                        Planning formations
                    </a>
                    <a href="#" class="quick-action">
                        <i class="fas fa-certificate"></i>
                        Certifications
                    </a>
                    <a href="#" class="quick-action">
                        <i class="fas fa-book"></i>
                        Ressources
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Row -->
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Statistiques des incidents</h5>
                    <div class="chart-container">
                        <canvas id="incidentsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Types d'incidents</h5>
                    <div class="chart-container">
                        <canvas id="incidentTypesChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Incidents Line Chart
    const incidentsCtx = document.getElementById('incidentsChart').getContext('2d');
    new Chart(incidentsCtx, {
        type: 'line',
        data: {
            labels: ['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Juin'],
            datasets: [{
                label: 'Incidents',
                data: [12, 19, 15, 8, 12, 10],
                borderColor: '#3498db',
                tension: 0.4,
                fill: false
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // Incident Types Pie Chart
    const typesCtx = document.getElementById('incidentTypesChart').getContext('2d');
    new Chart(typesCtx, {
        type: 'doughnut',
        data: {
            labels: ['Sécurité', 'Environnement', 'Santé'],
            datasets: [{
                data: [45, 30, 25],
                backgroundColor: ['#e74c3c', '#2ecc71', '#3498db']
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });
</script>
{% endblock %}
{% endblock %}
